(()=>{"use strict";var e={357:e=>{function n(e,n){if(null!=e)return e;var t=new Error(void 0!==n?n:"Got unexpected "+e);throw t.framesToPop=1,t}e.exports=n,e.exports.default=n,Object.defineProperty(e.exports,"__esModule",{value:!0})}},n={};function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{}};return e[i](r,r.exports,t),r.exports}(()=>{function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var s,a=function(){function n(t,i,s){var a=this;e(this,n),r(this,"document",void 0),r(this,"sender",void 0),r(this,"isActive",!0),r(this,"port",void 0),r(this,"charLimit",1e3),r(this,"charCount",0),r(this,"resetTimeMs",0),r(this,"minuteMs",6e4),r(this,"HTMLInputElement",void 0),r(this,"HTMLElement",void 0),r(this,"lastEventTimeMs",0),r(this,"betweenEventsTresholdMs",100),this.HTMLInputElement=t.HTMLInputElement,this.HTMLElement=t.HTMLElement,this.document=t.document,this.sender=i,this.port=s.connect(),this.port.onDisconnect.addListener((function(){a.onDisconnect()})),t.addEventListener("keydown",(function(e){a.keyPressListener(e)}),!0),t.addEventListener("paste",(function(e){a.pasteListener(e)}),!0),t.addEventListener("change",(function(e){a.changeListener(e)}),!0)}return i(n,[{key:"keyPressListener",value:function(e){var n=e.target;if(n instanceof this.HTMLElement&&"true"!==n.getAttribute("data-lexical-editor")){var t=e.key;if(void 0!==t&&"Unidentified"!==t&&1===t.length){if(!this.checkGuardians())return;var i={type:"key_pressed",payload:{key:t,referrer:this.document.referrer,location:this.document.location}};this.sender.sendMessage(i)}}}},{key:"pasteListener",value:function(e){var n;if(this.checkGuardians()){var t=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text");if(t){var i={type:"string_inserted",payload:{string:t,referrer:this.document.referrer,location:this.document.location}};this.sender.sendMessage(i)}}}},{key:"changeListener",value:function(e){var n=Date.now();if("lastEventTimeMs = ".concat(this.lastEventTimeMs,", timeNowMs=").concat(n),!(this.lastEventTimeMs+this.betweenEventsTresholdMs>=n)&&this.checkGuardians()){var t=e.target;if(t instanceof this.HTMLInputElement&&("text"===t.type||"password"===t.type)){var i={type:"change_made",payload:{string:t.value,referrer:this.document.referrer,location:this.document.location}};this.sender.sendMessage(i)}}}},{key:"checkGuardians",value:function(){return this.isActive&&!!this.checkRateLimit()||!1}},{key:"checkRateLimit",value:function(){var e=Date.now();return this.lastEventTimeMs=e,"lastEventTimeMs = ".concat(this.lastEventTimeMs),this.resetTimeMs<e&&(this.resetTimeMs=e+this.minuteMs,this.charCount=0),this.charCount++,!(this.charCount>this.charLimit)}},{key:"onDisconnect",value:function(){this.deactivate()}},{key:"deactivate",value:function(){this.isActive=!1}}]),n}(),o=function(){function n(t){e(this,n),r(this,"runtime",void 0),this.runtime=t}return i(n,[{key:"sendMessage",value:function(e){this.runtime.sendMessage(e)}}]),n}(),c=function(){function n(t,i,s){var a=this;e(this,n),r(this,"warningDisplay",void 0),r(this,"listener",void 0),this.warningDisplay=i,this.listener=s,t.onMessage.addListener((function(e,n){a.messageListener(e,n)}))}return i(n,[{key:"messageListener",value:function(e,n){switch(e.type){case"password_reuse_detected":this.warningDisplay.show(e.pageType);break;case"known_domain_detected":this.listener.deactivate();break;default:e.type}}}]),n}(),d=t(357),u=new Uint8Array(16);function l(){if(!s&&!(s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(u)}const h=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,f=function(e){return"string"==typeof e&&h.test(e)};for(var p=[],m=0;m<256;++m)p.push((m+256).toString(16).substr(1));const v=function(e,n,t){var i=(e=e||{}).random||(e.rng||l)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,n){t=t||0;for(var r=0;r<16;++r)n[t+r]=i[r];return n}return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(p[e[n+0]]+p[e[n+1]]+p[e[n+2]]+p[e[n+3]]+"-"+p[e[n+4]]+p[e[n+5]]+"-"+p[e[n+6]]+p[e[n+7]]+"-"+p[e[n+8]]+p[e[n+9]]+"-"+p[e[n+10]]+p[e[n+11]]+p[e[n+12]]+p[e[n+13]]+p[e[n+14]]+p[e[n+15]]).toLowerCase();if(!f(t))throw TypeError("Stringified UUID is invalid");return t}(i)};var g=function(){function n(t){e(this,n),r(this,"document",void 0),r(this,"inIframe",!1),r(this,"idPrefix",""),this.document=t.document,this.inIframe=t!==t.parent,this.idPrefix="fb_".concat(v(),"_").replace(/-/g,"_")}return i(n,[{key:"show",value:function(e){if(!this.inIframe){var n=d(this.document.getElementsByTagName("body")[0],"this document has no body element"),t="".concat(this.idPrefix,"dialog"),i=this.document.getElementById(t);if(null!=i)i.open||i.showModal();else{var r="".concat(this.idPrefix,"cancel"),s="internal"===e?"your corporate facebook password":"your personal password for www.facebook.com",a=this.document.createElement("dialog");a.id=t,a.innerHTML='\n      <style type="text/css">\n          .bbCancelButton:hover {\n            background: darkgray;\n          }\n          .bbCancelButton{\n            border: none;\n            border-radius:4px;\n            height: 40px;\n            font-weight: bold;\n            padding: 0 16 0 16\n          }\n          .FBWarningDialog {\n            border-radius: 8px;\n            border: 1px solid gray;\n            border-left: 16px solid rgb(241, 168, 23);\n          }\n          .FBFlexWarningContent {\n            display: flex;\n            padding-top: 16px;\n            font-family: \'SF Pro Text\', system-ui, -apple-system, BlinkMacSystemFont, \'.SFNSText-Regular\', sans-serif;\n          }\n          .FBWarningIcon {\n            color:rgb(241, 168, 23);\n            font-size: 28px;\n            font-weight: bold;\n          }\n          .FBCancelButtonContainer {\n            position: relative;\n            top: 50%;\n            transform: translate(-50%, -50%);\n            left: 50%;\n          }\n          .FBCancelButtonFlexContainer {\n            flex: 10%;\n            min-height: 100%\n          }\n          .FBWarningIconContainer {\n            flex: 6%;\n            text-align: center\n          }\n          .FBWarningText {\n            padding-left: 4px;\n            flex: 84%\n          }\n      </style>\n      <form method="dialog" class="FBWarningDialog">\n        <div class="FBFlexWarningContent">\n          <div class="FBWarningIconContainer">\n            <span class="FBWarningIcon">&#9888;</span>\n          </div>\n          <div class="FBWarningText">\n            <b>Facebook has detected password reuse</b>\n            <p>\n              You typed '.concat(s,' on this page. It might be a phishing attack.\n            </p>\n            <p>\n              A new tab with a help page has been opened.\n            </p>\n          </div>\n          <div class="FBCancelButtonFlexContainer">\n            <div class="FBCancelButtonContainer">\n              <button\n                id="').concat(r,'"\n                type="reset"\n                class="bbCancelButton">\n                OK\n              </button>\n            </div>\n          </div>\n        </div>\n      </form>\n      '),n.appendChild(a),a.showModal();var o=document.getElementById("".concat(r));null!=o&&o.addEventListener("click",(function(){a.close("cancel")}))}}}}]),n}();!function(e,n){var t=new o(e.runtime),i=new a(n,t,e.runtime),r=new g(n);new c(e.runtime,r,i)}(chrome,window)})()})();